<html>
    <head>
        <title>리뷰 게시판</title>
    </head>
    <body>
        <h1>리뷰 게시판 페이지입니다</h1>

        <ul>
            {% for post in posts %}
                <li><a href="{{post.pk}}/">{{post.postname}}</a></li>
        {% endfor %}
        </ul>


        <!-- <button><a href="new_post/?board_type=review_board">글쓰기</a></button> -->
        {% if request.user.is_authenticated %}
            <button id="writePostButton">글쓰기</button>
        {% else %}
            <button id="writePostButton" disabled>글쓰기</button>
            <span>로그인이 필요합니다.</span>
        {% endif %}
    </body>
    <script>
        // 버튼 클릭 시 동작
        document.getElementById("writePostButton").addEventListener("click", function() {
            // 서버에 요청 전에 먼저 로그인 상태를 확인
            fetch('/check_login_status/')
                .then(response => response.json())
                .then(data => {
                    if (data.logged_in) {
                        // 로그인된 경우 글쓰기 페이지로 이동
                        window.location.href = "/new_post/?board_type=free_board";
                    } else {
                        // 로그인되지 않은 경우 메시지 표시
                        alert("로그인이 필요합니다.");
                    }
                });
        });
        </script>
</html>